#!/bin/bash

if docker --version &> /dev/null; then
    echo "Docker is already installed."
else
    echo "Installing docker ...."
    curl -s https://raw.githubsercontent.com/shivashankarbukka402/install/main/docker | sudo bash
fi

echo "Create volumes for sonarqube to persist date"
docker volume create --name sonarqube_data
docker volume create --name sonarqube_logs
docker volume create --name sonarqube_extensions

docker run -d --name sonarqube \
    -p 9000:9000 \
    -e SONAR_JDBC_USERNAME=admin \
    -e SONAR_JDBC_PASSWORD=admin \
    -v sonarqube_data:/opt/sonarqube/data \
    -v sonarqube_extensions:/opt/sonarqube/extensions \
    -v sonarqube_logs:/opt/sonarqube/logs \
    sonarqube

echo "SonarQube, a default user with Administer System permission is created automatically: "
echo "Login: admin. password: admin"
